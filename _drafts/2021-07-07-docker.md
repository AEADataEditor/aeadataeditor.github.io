---
title:  "Use of Docker for Reproducibility in Economics"
layout: single-withtoc
date: 2021-07-07
tags:
  - FAQ
  - Twitter
  - Docker
  - Code
---

Containers are "implementations of operating system-level virtualization," [^1], typically on Linux. The most common version is provided by [Docker](https://docker.com), but several other implementations exist. The use of containers as part of replication packages in economics is extremely low, and yet they have some advantages. This post will explore both pre-submission and post-publication uses of containers, as well as several shortcomings. 

<!-- more -->

## What are containers

In a nutshell, 

> "A container is a standard unit of software that packages up code and all its dependencies so the application runs quickly and reliably from one computing environment to another." [^2]

In particular, this means that all dependencies are handled, and there should be virtually no differences across time, users' operating system, and software implementation in reproducing the outcomes of software.

Containers

## Containers in computational social science 

For the (social science) research environment, this should, in principle, handle many of the common issues that workarounds and READMEs list. In this post, we will explore one such case, in which a computational issue was encountered, debugged leveraging both locally installed and cloud-based containers, and ultimately solved. 

- Run Intel Fortran through container
- Run R or Stata through a container
- Run Gurobi through container
- Issues with licenses

## Compiling Fortran code through a container

Compilers are the workhorses for high-performance computing, and many economists will program compute-intensive routines in Fortran, then compile and run such code. Both open-source [^osfortran] and commercial[^commfortran] are available. We describe two use cases for using Fortran in combination with Docker. In many cases, compilers require the presence of many separate libraries, and installation is traditionally complicated. 

The [CE-Fortran](https://www.ce-fortran.com/) project ("Computational Economics using Fortran", Hans Fehr and Fabian Kindermann) trains and guides economists using open source [GNU Fortran](https://gcc.gnu.org/fortran/). They have traditionally provided detailed installation instructions for all three operation systems, striving to make the development environment as comparable as possible across all three. More recently, 

Created a master compile script (NOTE: this should really be a Makefile! The description is complete, but unnecessarily manual)
3. Downloaded the [Intel OneAPI-hpckit](https://hub.docker.com/r/intel/oneapi-hpckit/tags?page=1&ordering=last_updated)
```
docker pull intel/oneapi-hpckit:2021.2-devel-ubuntu18.04
```
4. Ran master script through the docker image
```
cd PATH/model_codes
docker run --rm -it -w /code -v $(pwd):/code intel/oneapi-hpckit:2021.2-devel-ubuntu18.04 /code/run_all.sh > run_all.output.txt
```
This generated about 100 output files. 


## Notes

[^1] Wikipedia. 2021. "List of Linux containers." [https://en.wikipedia.org/wiki/List_of_Linux_containers](hhttps://en.wikipedia.org/w/index.php?title=List_of_Linux_containers&oldid=1015376890), accessed on 2021-07-07.

[^2] Docker.com. 2021. "What is a Container." [https://www.docker.com/resources/what-container](https://web.archive.org/web/20210609145942/https://www.docker.com/resources/what-container), accessed on 2021-07-07.

[^osfortran] [GNU Fortran](https://gcc.gnu.org/fortran/) and various LLVM-based Fortran front-ends are available, see a list at [https://fortran-lang.org/compilers/](https://fortran-lang.org/compilers/).

[^commfortran] [Intel](https://software.intel.com/content/www/us/en/develop/tools/oneapi/all-toolkits.html) and [NAG](https://www.nag.com/nag-compiler) are popular.